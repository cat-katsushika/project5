{% extends 'base.html' %}
{% load static %}
{% load datetime_filters %}


{% block title %}
タスク新規作成
{% endblock title %}

{% block content %}
<div class="position-relative overflow-hidden p-3 p-md-5 m-md-3 text-center bg-body-tertiary">
    <div class="col-md-6 p-lg-5 mx-auto my-5">
        <h1 class="display-3 fw-bold">
            {{ task.title }}
            {% if task.status == "N" %}
            <span class="badge text-bg-primary">未開始</span>
            {% elif task.status == "I" %}
            <span class="badge text-bg-secondary">継続中</span>
            {% elif task.status == "D" %}
            <span class="badge text-bg-success">達成済み</span>
            {% elif task.status == "F" %}
            <span class="badge text-bg-danger">失敗</span>
            {% endif %}
        </h1>
        <h3 class="fw-normal text-muted mb-3">
            ユーザー: {{ task.user.username }}
        </h3>
        <h3 class="fw-normal text-muted mb-3">罰金額: {{ task.fine }}円</h3>

        <div class="row g-1 row-cols-auto justify-content-center">
            {% if request.user.is_authenticated %}
                <div class="col">
                    <a
                        href="{% url 'users:profile' request.user.id %}"
                        class="btn btn-secondary"
                    >
                        マイページへ
                    </a>
                </div>
            {% endif %}

            <div class="col">
                <a
                    href="{% url 'users:profile' task.user.id %}"
                    class="btn btn-secondary"
                >
                    このユーザーのマイページへ
                </a>
            </div>

            <div class="col">
                <button type="button" class="btn btn-secondary" id="ToastBtnForUrl">シェア用にURLをコピー</button>
            </div>
        </div>
    </div>
</div>

<p></p>

<ol class="list-group list-group-numbered">
    {% for todo in todo_list %}
    <li class="list-group-item d-flex justify-content-between align-items-start">
        <div class="ms-2 me-auto">
        <div class="fw-bold">{{ todo.date }} : {{ todo.date|days_diff:todo.task.created_at }}</div>
            {{ todo.task.title }}
        </div>
        {% if task.status == "N" %}
        <span class="badge text-bg-primary">未開始</span>
        {% elif todo.status == "I" %}
        <span class="badge text-bg-secondary">挑戦待ち</span>
        {% elif todo.status == "D" %}
        <span class="badge text-bg-success">達成済み</span>
        {% elif todo.status == "F" %}
        <span class="badge text-bg-danger">失敗</span>
        {% elif todo.status == "S" %}
        <span class="badge text-bg-warning">中断</span>
        {% endif %}
    </li>
    {% empty %}
    {% endfor %}
</ol>

<!-- URLコピー時のトースト -->
<div class="toast-container position-fixed bottom-0 end-0 p-3">
    <div id="toastForUrl" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
        <img src="{% static 'favicon/favicon.png' %}" class="rounded me-2" alt="継続or罰金のファビコン" width="20" height="20">
        <strong class="me-auto">継続or罰金</strong>
        <small>now</small>
        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
            <div id="myMessage">
                Hello, world! This is a toast message.
            </div>
        </div>
    </div>
</div>
<!-- URLコピー時のトースト -->

{% include 'tasks/copy_url_script.html' %}
{% endblock content %}